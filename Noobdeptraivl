local existing = game:GetService("CoreGui"):FindFirstChild("FlyControlGui")
if existing then
	existing:Destroy()
end

local TweenService = game:GetService("TweenService")
local ScreenGui = Instance.new("ScreenGui", game:GetService("CoreGui"))
ScreenGui.Name = "cmdbar"

local Frame = Instance.new("Frame")
Frame.Name = "MainFrame"
Frame.Size = UDim2.new(0, 160, 0, 120)
Frame.Position = UDim2.new(0.5, -80, 0.5, -60)
Frame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
Frame.BorderColor3 = Color3.fromRGB(20, 20, 20)
Frame.BorderSizePixel = 2
Frame.Active = true
Frame.Draggable = true
Frame.ClipsDescendants = true
Frame.Parent = ScreenGui

Instance.new("UICorner", Frame).CornerRadius = UDim.new(0, 8)

local Title = Instance.new("TextLabel", Frame)
Title.Name = "Title"
Title.Size = UDim2.new(1, 0, 0, 24)
Title.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
Title.BorderSizePixel = 0
Title.Text = "CmdBar"
Title.TextColor3 = Color3.fromRGB(200, 200, 200)
Title.Font = Enum.Font.Gotham
Title.TextSize = 12
Instance.new("UICorner", Title).CornerRadius = UDim.new(0, 8)

local Minimize = Instance.new("TextButton", Frame)
Minimize.Size = UDim2.new(0, 20, 0, 20)
Minimize.Position = UDim2.new(1, -50, 0, 2)
Minimize.Text = "-"
Minimize.TextSize = 14
Minimize.Font = Enum.Font.GothamBold
Minimize.TextColor3 = Color3.fromRGB(255, 255, 255)
Minimize.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
Minimize.BorderSizePixel = 0

local closeBtn = Instance.new("TextButton", Frame)
closeBtn.Size = UDim2.new(0, 20, 0, 20)
closeBtn.Position = UDim2.new(1, -25, 0, 2)
closeBtn.Text = "x"
closeBtn.TextSize = 14
closeBtn.Font = Enum.Font.GothamBold
closeBtn.TextColor3 = Color3.new(255, 255, 255)
closeBtn.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
closeBtn.BorderSizePixel = 0

local isMinimized = false
local fullSize = Frame.Size
local minimizedSize = UDim2.new(0, 160, 0, 24)

Minimize.MouseButton1Click:Connect(function()
	isMinimized = not isMinimized
	Minimize.Text = isMinimized and  "" or "-"
	local tweenInfo = TweenInfo.new(0.25, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
	local tween = TweenService:Create(Frame, tweenInfo, {Size = isMinimized and minimizedSize or fullSize})
	tween:Play()
	ToggleButton.Visible = not isMinimized
	SpeedSlider.Visible = not isMinimized
end)

closeBtn.MouseButton1Click:Connect(function()
	local parentGui = closeBtn:FindFirstAncestorWhichIsA("ScreenGui")
	if parentGui then
		parentGui:Destroy()
	end
end)
